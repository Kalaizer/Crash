<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crash Game</title>
    <style>
        body {
            background-color: #222;
            color: white;
            font-family: Arial, sans-serif;
            text-align: center;
        }
        .balance-panel {
            font-size: 24px;
            padding: 10px;
            background: #333;
            margin-bottom: 10px;
            display: inline-block;
            border-radius: 8px;
        }
        .button {
            padding: 10px 20px;
            margin: 10px;
            font-size: 18px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
        }
        .bet-button {
            background-color: orange;
            color: black;
        }
        .cashout-button {
            background-color: red;
            color: white;
        }
        .admin-panel {
            display: none;
            background: #444;
            padding: 10px;
            border-radius: 8px;
            position: fixed;
            bottom: 10px;
            left: 10px;
        }
        .admin-button {
            background: blue;
            color: white;
        }
        .chart {
            width: 80%;
            height: 300px;
            background: black;
            margin: 20px auto;
            border: 1px solid white;
            position: relative;
        }
        .chart-line {
            position: absolute;
            height: 2px;
            background: white;
        }
    </style>
</head>
<body>
    <h1>Crash Game</h1>
    <div class="balance-panel">Баланс: <span id="balance">0</span> монет</div>
    <br>
    <button class="button bet-button" id="bet">Поставить</button>
    <button class="button cashout-button" id="cashout">Вывести</button>
    <p id="possible-win">Возможный выигрыш: 0 монет</p>
    <div class="chart" id="chart">
        <div class="chart-line" id="chart-line"></div>
    </div>
    <p>Коэффициент: <span id="coefficient">1.00</span>×</p>
    <div>
        <h3>История последних игр</h3>
        <p id="history"></p>
    </div>

    <button class="button admin-button" id="admin-access">Админ</button>
    <div class="admin-panel" id="admin-panel">
        <input type="number" id="admin-money" placeholder="Сколько добавить">
        <button class="button admin-button" id="add-money">Добавить</button>
    </div>

    <script>
        let balance = localStorage.getItem('balance') ? parseFloat(localStorage.getItem('balance')) : 0;
        let history = JSON.parse(localStorage.getItem('history')) || [];
        let coefficient = 1.00;
        let gameActive = false;
        let betMade = false;
        let betAmount = 0;
        let interval;
        let speed = 0.01;

        document.getElementById('balance').innerText = balance.toFixed(1);
        updateHistory();

        function startGame() {
            gameActive = true;
            betMade = false;
            coefficient = 1.00;
            speed = 0.01;
            updateChart();
            interval = setInterval(() => {
                coefficient += speed;
                speed += 0.0005;
                document.getElementById('coefficient').innerText = coefficient.toFixed(2) + "×";
                document.getElementById('possible-win').innerText = betMade ? "Возможный выигрыш: " + (betAmount * coefficient).toFixed(1) + " монет" : "Возможный выигрыш: 0 монет";
                updateChart();
                if (coefficient >= 1000) stopGame();
            }, 100);
        }

        function stopGame() {
            clearInterval(interval);
            gameActive = false;
            history.unshift(coefficient.toFixed(2) + "×");
            if (history.length > 10) history.pop();
            localStorage.setItem('history', JSON.stringify(history));
            updateHistory();
            setTimeout(startGame, 5000);
        }

        function updateHistory() {
            document.getElementById('history').innerText = history.join(", ");
        }

        function updateChart() {
            let chartLine = document.getElementById('chart-line');
            chartLine.style.width = (coefficient * 10) + "px";
        }

        document.getElementById('bet').addEventListener('click', () => {
            if (betMade || !gameActive) {
                alert("Вы уже сделали ставку!");
                return;
            }
            let amount = parseFloat(prompt("Введите сумму ставки:"));
            if (amount > balance || amount <= 0) {
                alert("Недостаточно средств!");
                return;
            }
            betMade = true;
            betAmount = amount;
            balance -= amount;
            localStorage.setItem('balance', balance);
            document.getElementById('balance').innerText = balance.toFixed(1);
        });

        document.getElementById('cashout').addEventListener('click', () => {
            if (!betMade || !gameActive) {
                alert("Вы не сделали ставку!");
                return;
            }
            let winAmount = betAmount * coefficient;
            balance += winAmount;
            localStorage.setItem('balance', balance);
            document.getElementById('balance').innerText = balance.toFixed(1);
            betMade = false;
        });

        document.getElementById('admin-access').addEventListener('click', () => {
            let pass = prompt("Введите пароль:");
            if (pass === "1001") {
                document.getElementById('admin-panel').style.display = "block";
            } else {
                alert("Неверный пароль!");
            }
        });

        document.getElementById('add-money').addEventListener('click', () => {
            let amount = parseFloat(document.getElementById('admin-money').value);
            if (amount > 0) {
                balance += amount;
                localStorage.setItem('balance', balance);
                document.getElementById('balance').innerText = balance.toFixed(1);
            }
        });

        window.onload = startGame;
    </script>
</body>
</html>
