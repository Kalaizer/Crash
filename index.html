<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crash Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1d1d1d;
            color: white;
            text-align: center;
        }
        #container {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
        }
        #balance {
            font-size: 1.5em;
            margin-bottom: 20px;
        }
        .button {
            background-color: #ff6f00;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
        }
        .button:hover {
            background-color: #ff9f00;
        }
        #gameArea {
            margin-top: 20px;
            position: relative;
            height: 300px;
            background-color: black;
            border: 2px solid #ff6f00;
        }
        #crashLine {
            position: absolute;
            bottom: 10px;
            width: 100%;
            height: 5px;
            background-color: red;
        }
        #betAmount {
            font-size: 1.2em;
            margin-bottom: 20px;
        }
        #log {
            font-size: 0.9em;
            margin-top: 20px;
            background-color: #333;
            padding: 10px;
            height: 200px;
            overflow-y: scroll;
            border: 1px solid #ff6f00;
        }
    </style>
</head>
<body>
    <div id="container">
        <h1>Crash Game</h1>
        <div id="balance">Баланс: 50000 монет</div>
        <input type="number" id="betAmountInput" placeholder="Ставка (в монетах)" />
        <button class="button" id="startButton">Начать игру</button>
        <button class="button" id="withdrawButton" style="display: none;">Вывести</button>

        <div id="gameArea">
            <div id="crashLine"></div>
        </div>

        <div id="log"></div>
    </div>

    <script>
        const startButton = document.getElementById('startButton');
        const withdrawButton = document.getElementById('withdrawButton');
        const balanceElement = document.getElementById('balance');
        const betAmountInput = document.getElementById('betAmountInput');
        const gameArea = document.getElementById('gameArea');
        const crashLine = document.getElementById('crashLine');
        const logElement = document.getElementById('log');

        let balance = 50000;
        let betAmount = 0;
        let crashMultiplier = 1;
        let gameStarted = false;
        let gameCrashTime = 0;
        let crashInterval;

        startButton.addEventListener('click', startGame);
        withdrawButton.addEventListener('click', withdraw);

        function startGame() {
            betAmount = parseInt(betAmountInput.value);
            if (isNaN(betAmount) || betAmount <= 0 || betAmount > balance) {
                alert('Введите правильную сумму для ставки');
                return;
            }

            balance -= betAmount;
            balanceElement.textContent = `Баланс: ${balance} монет`;

            gameStarted = true;
            gameCrashTime = 0;
            crashMultiplier = 1;
            crashLine.style.height = '5px';
            crashLine.style.bottom = '10px';
            gameArea.style.backgroundColor = 'black';
            logElement.innerHTML = '';

            startButton.disabled = true;
            withdrawButton.style.display = 'none';

            crashInterval = setInterval(() => {
                if (gameStarted && crashMultiplier < 100) {
                    crashMultiplier += 0.1;
                    crashLine.style.height = `${crashMultiplier * 3}px`;
                    crashLine.style.bottom = `${10 + crashMultiplier * 3}px`;

                    if (crashMultiplier >= gameCrashTime) {
                        endGame('Игра окончена. Крах! Ваш множитель: ' + crashMultiplier.toFixed(2));
                        clearInterval(crashInterval);
                    }
                }
            }, 100);

            setTimeout(() => {
                gameCrashTime = Math.random() * 10 + 2;
            }, 500);
        }

        function endGame(message) {
            logMessage(message);

            if (crashMultiplier >= gameCrashTime) {
                logMessage('Вы не успели забрать ставку!');
            } else {
                balance += betAmount * crashMultiplier;
                balanceElement.textContent = `Баланс: ${balance.toFixed(2)} монет`;
            }

            startButton.disabled = false;
            withdrawButton.style.display = 'inline';
            gameStarted = false;
            crashMultiplier = 1;
            crashLine.style.height = '5px';
        }

        function logMessage(message) {
            const logEntry = document.createElement('div');
            logEntry.textContent = message;
            logElement.prepend(logEntry);
        }

        function withdraw() {
            if (balance > 0) {
                alert(`Вы вывели ${balance.toFixed(2)} монет`);
                balance = 0;
                balanceElement.textContent = 'Баланс: 0 монет';
            } else {
                alert('У вас нет средств для вывода');
            }
        }
    </script>
</body>
</html>
